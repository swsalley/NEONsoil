# NEON soil laboratory data from NASIS
# Shawn W. Salley, 20230106, Shawn.Salley@usda.gov
# NEON megapit n = 24, NEON distributed plots n = 971

library(neonUtilities) 
library(dplyr)

## Download Soil Characterization Data (distributed and Initial) ####
# these are from the 2022 release, rest of the data might be available in 2023

NEON.DP1.10047 <- loadByProduct(dpID="DP1.10047.001", site="all", package="expanded", release="RELEASE-2022") # Distributed Plots
# Answer = Y
NEON.DP1.00096 <- loadByProduct(dpID="DP1.00096.001", site="all", package="expanded", release="RELEASE-2022") # Mega Pits 
# Answer = Y

# Cleaned Distributed Plots SPC
spc_perplot <- NEON.DP1.10047$spc_perplot
spc_perplot <- spc_perplot %>% select("domainID", "siteID", "plotID", "pitID", "namedLocation", "plotType","nlcdClass", "geodeticDatum", 
                                      "decimalLatitude", "decimalLongitude","coordinateUncertainty", "elevation", 
                                       "collectDate",   "soilSamplingMethod", "sampleRelativeLocation", "pitDepth", "nrcsDescriptionID", 
                                      "soilSeries",  "soilFamily", "soilSubgroup", "soilGreatGroup", "soilSuborder",  "soilOrder")

spc_perhorizon <- NEON.DP1.10047$spc_perhorizon
spc_perhorizon <- spc_perhorizon %>% select("domainID", "siteID", "plotID", "pitID", "collectDate", "nrcsDescriptionID",
                                            "horizonID", "horizonName", "horizonTopDepth", "horizonBottomDepth", "remarks")

spc_bulkdensity <- NEON.DP1.10047$spc_bulkdensity
spc_bulkdensity <- spc_bulkdensity %>% select("horizonID", "bulkDensSampleType", "bulkDensCenterDepth", "bulkDensTopDepth",
                                              "bulkDensBottomDepth", "bulkDensThirdBar", "bulkDensOvenDry", "bulkDensFieldMoist", 
                                              "waterRetentionThirdBar", "fieldWaterContent", "remarks")
  
spc_particlesize <- NEON.DP1.10047$spc_particlesize
spc_particlesize <- spc_particlesize %>% select("horizonID", "coarseFrag2To5", "coarseFrag5To20", "sandTotal", "siltTotal", 
                                                "clayTotal", "carbonateClay", "clayFineContent", "siltFineContent", 
                                                "siltCoarseContent", "sandVeryFineContent", "sandFineContent", 
                                                "sandMediumContent", "sandCoarseContent", "sandVeryCoarseContent")

spc_biogeochem <- NEON.DP1.10047$spc_biogeochem
spc_biogeochem <- spc_biogeochem %>% select("horizonID",  "airDryOvenDryRatio",  "gypsumConc", "caco3Conc", "caNh4d", "kNh4d", 
                                            "mgNh4d", "naNh4d", "cecdNh4", "alSatCecd33", "baseSumCecd10", "bsesatCecd10", 
                                            "ececCecd33", "alKcl", "feKcl", "mnKcl", "phCacl2", "phH2o", "ec12pre",
                                            "bSatx", "brSatx", "caSatx", "clSatx", "co3Satx", "ecSatp", "flSatx", 
                                            "waterSatx", "hco3Sx", "kSatx", "mgSatx", "naSatx", "no2Satx", "no3Satx", "pSatx", "phSp",
                                            "so4Satx", "carbonTot", "nitrogenTot", "ctonRatio", "estimatedOC", "sulfurTot", 
                                            "alOxalate", "feOxalate", "mnOxalate", "pOxalate", "siOxalate", "optDensityOxalate",
                                            "alCitDithionate", "feCitDithionate", "mnCitDithionate", "siliconCitrateDithionate", 
                                            "acidity", "waterRetention15Bar", "MehlichIIITotP", "Bray1PExtractable", 
                                            "OlsenPExtractable", "archiveID", "archiveMass", "processingRemarks")  

# Cleaned Mega Pit SPC
mgp_permegapit <- NEON.DP1.00096$mgp_permegapit
mgp_permegapit <- mgp_permegapit %>% select("domainID", "siteID", "pitNamedLocation", "pitID", "decimalLatitude", "decimalLongitude",
                                            "coordinateUncertainty", "elevation", "collectDate", "soilSeries",  "soilFamily", 
                                            "soilSubgroup", "soilGreatGroup", "soilSuborder",  "soilOrder", "pitDepth", "nrcsDescriptionID" )

mgp_perhorizon <- NEON.DP1.00096$mgp_perhorizon
mgp_perhorizon <- mgp_perhorizon %>% select("domainID", "siteID", "pitNamedLocation", "pitID", "collectDate", "nrcsDescriptionID",
                                            "horizonID", "horizonName", "horizonTopDepth", "horizonBottomDepth", "remarks")

mgp_perbulksample <- NEON.DP1.00096$mgp_perbulksample
mgp_perbulksample <- mgp_perbulksample %>% select("horizonID", "bulkDensSampleType", "bulkDensCenterDepth", "bulkDensTopDepth",
                                              "bulkDensBottomDepth", "bulkDensHorizonProportion", "bulkDensSampleType", 
                                              "bulkDensExclCoarseFrag", "remarks")

names(mgp_perbiogeosample)

mgp_perbiogeosample <- NEON.DP1.00096$mgp_perbiogeosample
mgp_perbiogeosample <- mgp_perbiogeosample %>% select("horizonID", "coarseFrag2To5", "coarseFrag5To20", "sandTotal", "siltTotal", 
                                                      "clayTotal", "carbonateClay", "clayFineContent", "siltFineContent", 
                                                      "siltCoarseContent", "sandVeryFineContent", "sandFineContent", "sandMediumContent",
                                                      "sandCoarseContent", "sandVeryCoarseContent", "carbonTot", "nitrogenTot", 
                                                      "sulfurTot", "estimatedOC", "airDryOvenDry", "alMjelm", "caMjelm", "feMjelm", 
                                                      "kMjelm", "mgMjelm", "mnMjelm", "naMjelm", "pMjelm", "siMjelm", "srMjelm", 
                                                      "tiMjelm", "zrMjelm", "phCacl2", "phH2o", "ec12pre", "gypsumConc", "caco3Conc",
                                                      "caNh4d", "kNh4d", "mgNh4d", "naNh4d", "cecdNh4", "alSatCecd33", "baseSumCecd10", 
                                                      "bsesatCecd10", "ececCecd33", "alKcl", "feKcl", "mnKcl", "bSatx", "brSatx", "caSatx", 
                                                      "clSatx", "co3Satx", "ecSatp", "flSatx", "waterSatx", "hco3Sx", "kSatx", "mgSatx", 
                                                      "naSatx", "no2Satx", "no3Satx", "pSatx", "phSp", "resist", "so4Satx", 
                                                      "labProjID", "remarks")
